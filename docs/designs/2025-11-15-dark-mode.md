# Dark Mode Design

**Goal:** Add automatic dark mode support using `prefers-color-scheme` media query (no toggle switch).

**Date:** 2025-11-15

---

## Architecture

**Core Strategy:**
Use CSS `@media (prefers-color-scheme: dark)` to override semantic color tokens. Since the entire site uses CSS variables for colors, we only need one media query block that redefines the semantic tokens - no component changes required.

**Why this works:**
The existing design token architecture separates primitive colors from semantic tokens. All components reference semantic tokens (e.g., `--color-accent`, `--color-text-muted`), not primitives directly. This allows swapping the entire color palette in one place.

**Benefits:**
- Zero runtime JavaScript cost
- Instant response to OS preference changes
- Minimal CSS overhead (~200 bytes)
- Zero component changes needed
- Maintains existing light mode exactly as-is

---

## Color Palette

### New Primitive Colors (Dark Mode Specific)

```css
--color-rose-400: #fb7185;        /* Brighter rose for dark mode accents */
--color-gray-200: #e5e5e5;        /* Body text */
--color-gray-300: #d4d4d4;        /* Headings/strong emphasis */
--color-gray-600: #a3a3a3;        /* Muted text */
--color-dark-bg: #1a1a1a;         /* Page background */
```

### Semantic Token Overrides

```css
@media (prefers-color-scheme: dark) {
  :root {
    /* Brand colors - brighten for contrast */
    --color-accent: var(--color-rose-500);
    --color-accent-hover: var(--color-rose-400);

    /* Text colors - soft whites with hierarchy */
    --color-text-primary: var(--color-gray-200);
    --color-text-heading: var(--color-gray-300);
    --color-text-muted: var(--color-gray-600);
    --color-text-secondary: var(--color-gray-600);

    /* Backgrounds */
    --color-bg-page: var(--color-dark-bg);

    /* Code blocks - subtle contrast adjustment */
    --color-code-bg: #0d1116;
    --color-code-badge-bg: rgba(255, 255, 255, 0.1);
    --color-code-badge-text: rgba(255, 255, 255, 0.6);
  }
}
```

### Color Decisions

**Background:** Dark gray (#1a1a1a) instead of true black - easier on eyes for reading
**Text:** Reduced contrast (#e5e5e5) for body, softer than pure white - better for long reading sessions
**Accents:** Rose-500/400 instead of 600/500 - better visibility against dark background
**Code blocks:** Minimal change - already dark, just adjust badge contrast

---

## Implementation

### Files to Modify

**1. `app/global.css`**
- Add new dark mode primitive colors to `:root`
- Add `@media (prefers-color-scheme: dark)` block with semantic overrides
- Add new `--color-text-primary` and `--color-bg-page` tokens
- Add CSS rule: `body { background: var(--color-bg-page); color: var(--color-text-primary); }`

**2. `app/layout.tsx`**
- Remove hardcoded `bg-white` class
- Keep `text-base` for font sizing
- Let CSS variables handle background and text colors

**3. `tailwind.config.js`**
- Add new color tokens to `theme.extend.colors`:
  - `bg-page`
  - `text-primary`
  - `text-heading`

**4. `CLAUDE.md`**
- Document design tokens system
- Document dark mode implementation
- Update styling approach section

### What Stays the Same

- All components (already using semantic tokens)
- All CSS modules (already using CSS variables)
- Typography plugin configuration
- Component utilities
- Zero new dependencies

---

## Testing

**Manual verification:**
1. Test in light mode (default OS preference)
2. Switch OS to dark mode, verify instant theme change
3. Test all pages:
   - Homepage (cards, links)
   - Post pages (code blocks, metadata)
   - 404 page
4. Verify text hierarchy maintained in both modes
5. Check code block badge contrast in dark mode

**Expected behavior:**
- Instant theme switching when OS preference changes
- No flash of unstyled content
- Consistent colors across all pages
- Code blocks remain readable in both modes
- Rose accent colors visible in both modes

---

## Future Enhancements

If user preference needed later:
- Add localStorage-based override
- Add toggle switch in UI
- Respect both OS preference AND user override

Current implementation makes this trivial to add since all color logic is centralized.
